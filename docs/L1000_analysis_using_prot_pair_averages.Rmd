---
title: "L1000_analysis_using_prot_pair_averages"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Loading data

Load in the L1000_prot_pair_averages.rdata file from github

This is the data created in the L1000_protein_pairs_creating_averages.R script 

We have multiplied the shRNA z-scores by -1

The shRNA is a loss of function perturbagen, the cDNA peturbagen over expresses wild type genes, therfore to make them comparable we multiple the shRNA z-scores by -1

```{r}

githubURL <- "https://github.com/hw15842/L1000_protein_pair_trait_MR/blob/master/Data/L1000_prot_pair_averages.rdata?raw=true"
load(url(githubURL))
head(L1000_prot_pair_averages)

```

## Investigating the dataset

What are some features of this data

```{r}
summary(L1000_prot_pair_averages$mean)
```

## Extracting significant z-scores 

We use the pnorm() func to turn the z-scores into p-values

we determine if it is a significant p-value by dividing 0.05 by 401,080 - this is the number of original protein pairs before adding "forward and reverse" prot pairs 

```{r}

L1000_prot_pair_averages$pval_mean_z <- pnorm(L1000_prot_pair_averages$mean)
L1000_prot_pair_averages$sig_zscore <- ifelse(L1000_prot_pair_averages$pval_mean_z < (0.05/401080), "Yes", "No")

table(L1000_prot_pair_averages$sig_zscore)

# None of the protein pairs have a significant z-score at this threshold

# Just look at 0.05 threshold

L1000_prot_pair_averages$sig_zscore <- ifelse(L1000_prot_pair_averages$pval_mean_z < 0.05, "Yes", "No")

table(L1000_prot_pair_averages$sig_zscore)

```

So there are only 48 protein pairs that are significant at the very high threshold of 0.05.. 
